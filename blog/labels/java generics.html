<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--

Sergio Annecchiarico - thanks very much to:

Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Modified by Sergio Annecchiarico - feel free to tweak some more if you like...

-->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>serg.io</title>
    <meta name="keywords" content="blog, java, annecchiarico, sergio annecchiarico" />
    <meta name="description" content="Sergio Annecchiarico's blog" />

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="alternate" type="application/atom+xml" title="Atom" href="http://feeds.feedburner.com/Sergio" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/Sergio" />
    <link rel="alternate" type="application/rdf+xml" title="RSS" href="http://feeds.feedburner.com/Sergio" />
    <link rel="stylesheet" href="http://serg.io/blog/blog.css" type="text/css" media="all" />
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta name="generator" content="Blogger" />
<link rel="icon" type="image/vnd.microsoft.icon" href="http://www.blogger.com/favicon.ico"/>
<link rel="alternate" type="application/atom+xml" title="serg.io - Atom" href="http://serg.io/blog/atom.xml" />
<link rel="alternate" type="application/rss+xml" title="serg.io - RSS" href="http://serg.io/blog/rss.xml" />
<link rel="service.post" type="application/atom+xml" title="serg.io - Atom" href="http://www.blogger.com/feeds/4414172998613045683/posts/default" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.blogger.com/rsd.g?blogID=4414172998613045683" />
 <link rel="stylesheet" type="text/css" href="http://www.blogger.com/css/blog_controls.css"/> <link rel="stylesheet" type="text/css" href="http://www.blogger.com/dyn-css/authorization.css?targetBlogID=4414172998613045683&zx=8ff63df0-9f16-47df-8529-09a22b0afcaf"/><script type="text/javascript" src="http://www.blogger.com/js/backlink.js"></script>
<script type="text/javascript" src="http://www.blogger.com/js/backlink_control.js"></script>
<script type="text/javascript">var BL_backlinkURL = "http://www.blogger.com/dyn-js/backlink_count.js";var BL_blogId = "4414172998613045683";</script>

    
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
    <script type="text/javascript">
        _uacct = "UA-1603713-1";
        urchinTracker();
    </script>
    
    <script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAuIWsJ156A26oSIQ4J-tsFhRi6DQAIOh2wezzjKqD7VrrikLmVxTK-IW2dWfJ5Po3ux3pqnnkgOwYog"></script>
    <script type="text/javascript">

    google.load("feeds", "1");

    function initialize() {
      var feed = new google.feeds.Feed("http://www.google.com/reader/public/atom/user/00174624012215095220/state/com.google/broadcast");
      feed.load(function(result) {
        if (!result.error) {
          var container = document.getElementById("feed");
            for (var i = 0; i < result.feed.entries.length && i < 5; i++) {
              var entry = result.feed.entries[i];
              var li = document.createElement("li");
              var header = li.appendChild(document.createElement("h3"));
              var link = li.appendChild(document.createElement("a"));
              link.appendChild(document.createTextNode(entry.title));
              link.href = entry.link;
              link.target = "_blank";
              var auth = li.appendChild(document.createElement("h4"));
              auth.appendChild(document.createTextNode("posted by " + entry.author));
              var snippet = li.appendChild(document.createElement("p"));
              snippet.appendChild(document.createTextNode(entry.contentSnippet));
              container.appendChild(li);
           }
	}
      });
    }
    google.setOnLoadCallback(initialize);

    </script>
    
<link rel="me" href="http://www.blogger.com/profile/07642912205140526195" />
<link rel="openid.server" href="http://www.blogger.com/openid-server.g" />
<!-- --><style type="text/css">@import url(http://www.blogger.com/css/navbar/classic.css);
div.b-mobile {display:none;}
</style>

</head>

<body><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener("load",
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<iframe src="http://www.blogger.com/navbar.g?targetBlogID=4414172998613045683&amp;blogName=serg.io&amp;publishMode=PUBLISH_MODE_FTP&amp;navbarType=BLACK&amp;layoutType=CLASSIC&amp;homepageUrl=http%3A%2F%2Fserg.io%2Fblog%2F&amp;searchRoot=http%3A%2F%2Fblogsearch.google.com%2F" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" height="30px" width="100%" id="navbar-iframe" title="Blogger Navigation and Search"></iframe>
<div></div>
<div id="wrapper">
<div id="header">
    <div id="logo">
        <h1><a href="http://serg.io/blog">serg.io</a></h1>
        <h2>wittering and <a href="#">blathering</a> on</h2>
    </div>
    <div id="menu">
        <ul>
            <li class="active"><a href="http://serg.io/blog">blog</a></li>
            <li><a href="http://serg.io/about.html">about</a></li>
        </ul>
    </div>
</div>

<div id="page">
<div id="content">
<div id="welcome">

<div id="twitter_div">
  <ul id="twitter_update_list"></ul>
    <span id="twitter-link">
      according to <a href="http://twitter.com/serg10">Twitter</a>
      <a href="http://feeds.feedburner.com/Twitter/Serg10"><img style="border: none; vertical-align: middle;" src="http://serg.io/blog/images/feed-icon-10x10.png" alt="subscribe to my twitter feed" title="subscribe to my twitter feed" /></a>
    </span>
</div>


<h2>Java generics and constructor type inference</h2><a name="8591086565732437373"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>I started thinking about this over a curry with some colleagues who had some strong opinions on Java's generics.  A lot of the <a href="http://weblogs.java.net/blog/arnold/archive/2005/06/generics_consid_1.html">flack</a> directed at generics in Java, and even at Java itself, relates to its apparent verbosity.  Take the classic example of instantiating a new Map.</p><br /><pre class="codeBlock"><br />Map &lt;Integer, String&gt; crudeCache = new HashMap&lt;Integer, String&gt;();<br /></pre><br /><p>Why are the type parameters declared twice?  Can't the compiler infer the types used in the call to the generic constructor from the reference declaration?  This has been asked before, and there are a <a href="http://www.jroller.com/scolebourne/entry/java_7_short_declarations">few proposals</a>, but Neal Gafter's <a href="http://gafter.blogspot.com/2007/07/constructor-type-inference.html">recent post</a> seems the slickest to me.</p><br /><p>He proposes this syntax</p><br /><pre class="codeBlock"><br />Map &lt;Integer, String&gt; crudeCache = new HashMap&lt;&gt;();<br /></pre><br /><p>where the final &lt;&gt; is a signal to javac to do its type inference magic.  I like that.  The amount of typing is not that important - I haven't measured it, but I am sure I spend more time looking reading, and thinking about code than actually typing it.  Anyway, I rely on my IDE to do a lot of boilerplate coding.  However, this syntax looks much more elegant and readable.  So, then why not go one step further and omit the &lt;&gt;:</p><br /><pre class="codeBlock"><br />Map &lt;Integer, String&gt; crudeCache = new HashMap();<br /></pre><br /><p>Can't the compiler infer type in this case too?  Unfortunately not, as this would be confused with a backwardly compatible call to a raw type constructor.  Remember that raw types really are <a href="http://www.angelikalanger.com/GenericsFAQ/FAQSections/ParameterizedTypes.html#What%20is%20the%20difference%20between%20the%20unbounded%20wildcard%20instantiation%20and%20the%20raw%20type?">different</a> from unbounded wildcards, so for compatibility with legacy code they need to stay.  It is a pity that the least frequent use (raw type) would be the most terse.</p><br /><p>Type inference in general is a pretty tricky problem.  Java tries on occasion in a fairly simplistic way.  Take for example</p><br /><pre class="codeBlock"><br />List<String> noStrings = Collections.emptyList();<br /></pre><br /><p>In that situation javac manages to infer the type from the reference assignment.  Interestingly, the implementation of the <code>emptyList</code> method is rather crude looking.  It simply casts a raw List into the desired type and hides this chicanery behind a <code>@SuppressWarnings("unchecked")</code>.  However, typing is not compromised - you can't ever get anything out of the list, as it is immutable and has zero size, so the apparently unsafe cast is sound.</p><br /><p>When you not encumbered by backwards compatibility, simple syntax comes more easily.  Take for example how Scala handles this issue:</p><br /><pre class="codeBlock"><br />val scalaMap = new HashMap[Int, String](1, "types inferred")<br /></pre><br /><p>Whilst that concise syntax looks like it comes from a dynamically typed language, Scala is as statically typed as Java.  But as the type system is so well constrained, the <a href="http://lamp.epfl.ch/~odersky/">designer</a> (who was on the original Java generics "GJ" team) has been able to use <a href="http://www.scala-lang.org/intro/inference.html">local type inference</a> to provide both the generic type information, and the type of the reference declaration itself.  I am impressed by the clean look, but I think I'd miss the reference type on the left had side of the assignment as it must help when reading through the code.  Interesting to see what can be done on the jvm when you start with a clean sheet though.</p><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://serg.io/blog/labels/java generics.html">java generics</a></p>
    <div class="byline">
        <a href="http://serg.io/blog/2007/10/java-generics-and-constructor-type.html" title="permanent link">#</a> posted by Sergio on Sunday, October 07, 2007
        
            &nbsp;
                <a href="https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=8591086565732437373"location.href=https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=8591086565732437373;><span style="text-transform:lowercase">0 Comments</span></a>
            
            
                <a class="comment-link" href="http://serg.io/blog/2007/10/java-generics-and-constructor-type.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=8591086565732437373" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=8591086565732437373" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>


</div>
<!-- end div#welcome -->

<!--div id="sample1" class="boxed">
    
    <h2>Sample One</h2>
    <ul>
        <li><a href="#">Ut semper vestibulum est</a></li>
        <li><a href="#">Vestibulum luctus venenatis </a></li>
        <li><a href="#">Etiam malesuada enim</a></li>
        <li><a href="#">Aenean elementum facilisis </a></li>
        
        <li><a href="#">Ut tincidunt elit vitae augue</a></li>
        <li><a href="#">Sed quis odio sagittis leo </a></li>
    </ul>
</div-->
<!-- end div#sample1 -->
<!--div id="sample2" class="boxed">
    <h2>Sample Two</h2>
    
    <p>Quisque dictum nisl risus, sagittis, rutrum id, and nibh:</p>
    <ul>
        <li><a href="#">Integer rutrum nisl in mi</a></li>
        <li><a href="#">Etiam malesuada enim</a></li>
        <li><a href="#">Aenean elementum facilisis </a></li>
    </ul>
</div-->

<!-- end div#sample2 -->
</div>
<!-- end div#content -->
<div id="sidebar">
    <ul>
        <li id="submenu">
            <h2>Archives</h2>
            <ul>
                <li><a href='http://serg.io/blog/2007_05_01_archive.html'>May 2007</a></li><li><a href='http://serg.io/blog/2007_08_01_archive.html'>August 2007</a></li><li><a href='http://serg.io/blog/2007_10_01_archive.html'>October 2007</a></li><li><a href='http://serg.io/blog/2007_11_01_archive.html'>November 2007</a></li><li><a href='http://serg.io/blog/2008_01_01_archive.html'>January 2008</a></li><li><a href='http://serg.io/blog/2008_08_01_archive.html'>August 2008</a></li>
                <!-- Link to the front page, from your archives -->
                <script type="text/javascript">if (location.href.indexOf("archive")!=-1) document.write("<li><strong><a href=\"http://serg.io/blog/\">Current Posts</a></strong></li>");</script> 
            </ul>
        </li>
        <!-- end li#submenu -->
        <li id="news">
            <h2>Blog posts I'm reading</h2>
            <ul id="feed">

            </ul>
        </li>
        <!-- end li#news -->
    </ul>
    
    <!--div class='adsense' style='text-align:center; padding: 0px 3px 0.5em 3px;'>
                        <script type="text/javascript"--><!--
                            google_ad_client="pub-9053212304658958";
                            google_ad_host="pub-1556223355139109";
                            google_ad_width=300;
                            google_ad_height=250;
                            google_ad_format="300x250_as";
                            google_ad_type="text";
                            google_color_border="F6F6F6";
                            google_color_bg="F6F6F6";
                            google_color_link="000000";
                            google_color_url="777777";
                            google_color_text="9E5205";
                            //-->
    <!--/script>
                        <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
                    </div-->  
                    
</div>
<!-- end div#sidebar -->

<div style="clear: both; height: 1px"></div>
</div>
<!-- end div#page -->
<div id="footer">
    <p id="legal">Copyright &copy; 2007 serg.io.  Thanks to <a href="http://www.freecsstemplates.org/">Free CSS Templates</a> for css design.</p>
    <p id="links"><a href="#">Privacy Policy</a> | <a href="#">Terms of Use</a> | <a href="http://feeds.feedburner.com/Sergio">Subscribe</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio"><img style="border: none; vertical-align: middle;" src="images/feed-icon-12x12.png" alt="subscribe to blog updates" title="subscribe to blog updates" /></a></p>
<br/>
    <!-- In accordance to the Blogger terms of service, please leave this button somewhere on your blogger-powered page. Thanks! -->
    <p>
        <a href="http://www.blogger.com">
            <img width="88" height="31" src="http://buttons.blogger.com/bloggerbutton1.gif" border="0" alt="This page is powered by Blogger. Isn't yours?" />
        </a>
    </p>
<p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.0/uk/">
<img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/2.0/uk/88x31.png" />
</a>
<br />This work by 
<a xmlns:cc="http://creativecommons.org/ns#" href="http://serg.io" property="cc:attributionName" rel="cc:attributionURL">http://serg.io</a> is licensed under a 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.0/uk/">Creative Commons Attribution-Non-Commercial-Share Alike 2.0 UK: England & Wales License</a>.
</p>
</div>
<!-- end div#footer -->
</div>
<!-- end div#wrapper -->

<!-- twitter updates -->
<script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
<script text="text/javascript" src="http://twitter.com/statuses/user_timeline/serg10.json?callback=twitterCallback2&count=1"></script>

</body>
</html>