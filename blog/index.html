<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--

Sergio Annecchiarico - thanks very much to:

Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Modified by Sergio Annecchiarico - feel free to tweak some more if you like...

-->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>serg.io</title>
    <meta name="keywords" content="blog, java, annecchiarico, sergio annecchiarico" />
    <meta name="description" content="Sergio Annecchiarico's blog" />

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="alternate" type="application/atom+xml" title="Atom" href="http://feeds.feedburner.com/Sergio" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/Sergio" />
    <link rel="alternate" type="application/rdf+xml" title="RSS" href="http://feeds.feedburner.com/Sergio" />
    <link rel="stylesheet" href="http://serg.io/blog/blog.css" type="text/css" media="all" />
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta name="generator" content="Blogger" />
<link rel="icon" type="image/vnd.microsoft.icon" href="http://www.blogger.com/favicon.ico"/>
<link rel="alternate" type="application/atom+xml" title="serg.io - Atom" href="http://serg.io/blog/atom.xml" />
<link rel="alternate" type="application/rss+xml" title="serg.io - RSS" href="http://serg.io/blog/rss.xml" />
<link rel="service.post" type="application/atom+xml" title="serg.io - Atom" href="http://www.blogger.com/feeds/4414172998613045683/posts/default" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.blogger.com/rsd.g?blogID=4414172998613045683" />
 <link rel="stylesheet" type="text/css" href="http://www.blogger.com/css/blog_controls.css"/> <link rel="stylesheet" type="text/css" href="http://www.blogger.com/dyn-css/authorization.css?targetBlogID=4414172998613045683&zx=8ff63df0-9f16-47df-8529-09a22b0afcaf"/><script type="text/javascript" src="http://www.blogger.com/js/backlink.js"></script>
<script type="text/javascript" src="http://www.blogger.com/js/backlink_control.js"></script>
<script type="text/javascript">var BL_backlinkURL = "http://www.blogger.com/dyn-js/backlink_count.js";var BL_blogId = "4414172998613045683";</script>

    
    <script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
    <script type="text/javascript">
        _uacct = "UA-1603713-1";
        urchinTracker();
    </script>
    
    <script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAuIWsJ156A26oSIQ4J-tsFhRi6DQAIOh2wezzjKqD7VrrikLmVxTK-IW2dWfJ5Po3ux3pqnnkgOwYog"></script>
    <script type="text/javascript">

    google.load("feeds", "1");

    function initialize() {
      var feed = new google.feeds.Feed("http://www.google.com/reader/public/atom/user/00174624012215095220/state/com.google/broadcast");
      feed.load(function(result) {
        if (!result.error) {
          var container = document.getElementById("feed");
            for (var i = 0; i < result.feed.entries.length && i < 5; i++) {
              var entry = result.feed.entries[i];
              var li = document.createElement("li");
              var header = li.appendChild(document.createElement("h3"));
              var link = li.appendChild(document.createElement("a"));
              link.appendChild(document.createTextNode(entry.title));
              link.href = entry.link;
              link.target = "_blank";
              var auth = li.appendChild(document.createElement("h4"));
              auth.appendChild(document.createTextNode("posted by " + entry.author));
              var snippet = li.appendChild(document.createElement("p"));
              snippet.appendChild(document.createTextNode(entry.contentSnippet));
              container.appendChild(li);
           }
	}
      });
    }
    google.setOnLoadCallback(initialize);

    </script>
    
<link rel="me" href="http://www.blogger.com/profile/07642912205140526195" />
<link rel="openid.server" href="http://www.blogger.com/openid-server.g" />
<!-- --><style type="text/css">@import url(http://www.blogger.com/css/navbar/classic.css);
div.b-mobile {display:none;}
</style>

</head>

<body><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener("load",
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<iframe src="http://www.blogger.com/navbar.g?targetBlogID=4414172998613045683&amp;blogName=serg.io&amp;publishMode=PUBLISH_MODE_FTP&amp;navbarType=BLACK&amp;layoutType=CLASSIC&amp;homepageUrl=http%3A%2F%2Fserg.io%2Fblog%2F&amp;searchRoot=http%3A%2F%2Fblogsearch.google.com%2F" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" height="30px" width="100%" id="navbar-iframe" title="Blogger Navigation and Search"></iframe>
<div></div>
<div id="wrapper">
<div id="header">
    <div id="logo">
        <h1><a href="http://serg.io/blog">serg.io</a></h1>
        <h2>wittering and <a href="#">blathering</a> on</h2>
    </div>
    <div id="menu">
        <ul>
            <li class="active"><a href="http://serg.io/blog">blog</a></li>
            <li><a href="http://serg.io/about.html">about</a></li>
        </ul>
    </div>
</div>

<div id="page">
<div id="content">
<div id="welcome">

<div id="twitter_div">
  <ul id="twitter_update_list"></ul>
    <span id="twitter-link">
      according to <a href="http://twitter.com/serg10">Twitter</a>
      <a href="http://feeds.feedburner.com/Twitter/Serg10"><img style="border: none; vertical-align: middle;" src="http://serg.io/blog/images/feed-icon-10x10.png" alt="subscribe to my twitter feed" title="subscribe to my twitter feed" /></a>
    </span>
</div>


<h2>Generics in Java are not so bad.  Stop your moaning!</h2><a name="241043496984854559"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>It seems a commonly held belief that due to <a href="http://java.sun.com/docs/books/tutorial/java/generics/erasure.html">type erasure</a>, Java's implementation of generics is somehow tainted.  I mean, it is <strong>just</strong> compiler magic right?  The comparison with the .net languages is a frequent one.  Having generic type information availble at runtime certainly has benefits in that reflection works and the .net CLR is able to make more optimisations by avoiding the casting / boxing overheads.<br /><br />The argument for Sun's decision to go with type erasure - backwards compatibility - is well appreciated.  However, I didn't realise until recently that generics were bolted onto .net after the initial release.  Obviously Microsoft didn't wait as long as Sun did, but they were definitely not there from the outset.  So, all of the same compatibility problems that Java suffered applies to net too.  But, as Microsoft opted for the non-backwardsly compatible route and allowed reifiable types, they essentially deprecated all of the existing library classes that work with non-generic types.<br /><br />Which in many ways seems like a real shame.  From a purely aesthetic point of view, C# is a very elegant language that neatly avoids a lot of Java's legacy <a href="http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html">cruft</a>.  What a shame to have a whole package of non-generic collections classes sitting in the background like a wart on the core API.  And so early on in the language's lifetime.<br /><br />Here's another example.  As Enum already existed in C#, it could not be generic-afied (pretty sure that is not a verb...) without breaking all existing usages.  So Enum in C# does not have a crazy looking definition like in Java:<br /><br /><pre class="codeBlock"><br />public abstract class Enum&lt;E extends Enum&lt;E&gt;&gt; <br />extends Object implements Comparable&lt;E&gt;, Serializable<br /></pre><br /></p><p><br />(Angelika Langer has the <a href="http://www.angelikalanger.com/GenericsFAQ/FAQSections/TypeParameters.html#How%20do%20I%20decrypt%20Enum?">best explanation </a>of this initially baffling splurge of brackets.<br /><br />Which means that parsing a String to an enum value cannot be done in a typesafe way, and takes some hoop jumping in C#:<br /><br /><pre class="codeBlock"><br />//  Parsing String to Enum in C#<br />Colour colour = (Colour)Enum.Parse(typeof(Colour), "RED");<br /></pre><br /></p><p><br />Compare this to the elegant version possible with Java's api:<br /><pre class="codeBlock"><br />//  Parsing String to Enum in Java<br />Colour colour = Colour.valueOf("RED");<br /></pre><br /></p><p><br />It feels like a missed opportunity.  The brave decision was to break backwards compatibility for the sake of a purist and better functioning approach to generics.  Pity then to sidestep the controversy by not applying this to all of the existing libraries - C# is already saddled with crufty code in its core libraries.<br /></p><div style="clear:both; padding-bottom:0.25em"></div>
    <div class="byline">
        <a href="http://serg.io/blog/2008/08/generics-in-java-are-not-so-bad-stop.html" title="permanent link">#</a> posted by Sergio on Thursday, August 28, 2008
        
            &nbsp;
                <a href="https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=241043496984854559"location.href=https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=241043496984854559;><span style="text-transform:lowercase">0 Comments</span></a>
            
            
                <a class="comment-link" href="http://serg.io/blog/2008/08/generics-in-java-are-not-so-bad-stop.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=241043496984854559" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=241043496984854559" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>

<h2>New year's resolution - be concise, but not terse</h2><a name="1210739757921681089"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>I've just finished Strunk and White's classic <a href="http://books.google.co.uk/books?id=FyH_qs6CS4cC&pgis=1">The Elements of Style</a> which I strongly recommend.  It teaches you to review your writing before inflicting it on its readers.  The book is under 100 pages which proves the authors understand concise use of the language.  On top of that, it is an enjoyable little book to read.  In the same way, the brevity of your coded language is important.  Here's a great example from the Java api:<br /><pre class="codeBlock">Set&lt;Colour&gt; primaries = EnumSet.of(RED, BLUE, YELLOW);</pre></p><p>There is something beautiful about the perfectly-named method "<code>of</code>".  Since <a href="http://books.google.co.uk/books?id=ZZOiqZQIbRMC">Effective Java</a> we all know to favour static factory methods over constructors.  When dealing with generics it is even more important.  Until <a href="http://serg.io/blog/2007/10/java-generics-and-constructor-type.html">constructor type inference</a> arrives in Java, the constructor version would be comparatively cumbersome<br /><pre class="codeBlock">Set&lt;Colour&gt; primaries = new EnumSet&lt;Colour&gt;(RED, BLUE, YELLOW);</pre></p><p>In some future generation of the language, an operator overloading could provide more terse code.  Maybe something like:<br /><pre class="codeBlock">EnumSet&lt;Colour&gt; primaries += {RED, BLUE, YELLOW};</pre></p><p>I'd argue that the <code>of</code> method is aesthetically more pleasing than the overloading.  That's the difference between being concise and terse.  Brief, clear and accurate, but not to the point of alienating those that have to read it.</p><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://serg.io/blog/labels/java.html">java</a>, <a rel='tag' href="http://serg.io/blog/labels/style.html">style</a></p>
    <div class="byline">
        <a href="http://serg.io/blog/2008/01/new-years-resolution-be-concise-but-not.html" title="permanent link">#</a> posted by Sergio on Saturday, January 12, 2008
        
            &nbsp;
                <a href="https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=1210739757921681089"location.href=https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=1210739757921681089;><span style="text-transform:lowercase">0 Comments</span></a>
            
            
                <a class="comment-link" href="http://serg.io/blog/2008/01/new-years-resolution-be-concise-but-not.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=1210739757921681089" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=1210739757921681089" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>

<h2>The obligatory shameless cross link self promotion blog entry...</h2><a name="6419423514976435408"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>Check out my new <a href="http://www.codingthearchitecture.com/2007/11/16/wheres_the_coffee_machine.html">mercifully short post</a> on the codingthearchitecture blog.<br /><br/>I recently told <a href="http://www.simongbrown.com">Simon</a> via <a href="http://twitter.com/serg10/statuses/297297902">twitter</a>* that I wouldn't call myself an architect until I posted on the codingthearchitecture blog.  He mocked me.  To be honest, I still do not know if I would use that term as in my experience it can sound a little standoffish.<br /><small>* does the act of mocking someone on twitter have a verb - "twatter" maybe?</small></p><div style="clear:both; padding-bottom:0.25em"></div>
    <div class="byline">
        <a href="http://serg.io/blog/2007/11/obligatory-shameless-cross-link-self.html" title="permanent link">#</a> posted by Sergio on Friday, November 16, 2007
        
            &nbsp;
                <a href="https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=6419423514976435408"location.href=https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=6419423514976435408;><span style="text-transform:lowercase">0 Comments</span></a>
            
            
                <a class="comment-link" href="http://serg.io/blog/2007/11/obligatory-shameless-cross-link-self.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=6419423514976435408" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=6419423514976435408" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>

<h2>Java generics and constructor type inference</h2><a name="8591086565732437373"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>I started thinking about this over a curry with some colleagues who had some strong opinions on Java's generics.  A lot of the <a href="http://weblogs.java.net/blog/arnold/archive/2005/06/generics_consid_1.html">flack</a> directed at generics in Java, and even at Java itself, relates to its apparent verbosity.  Take the classic example of instantiating a new Map.</p><br /><pre class="codeBlock"><br />Map &lt;Integer, String&gt; crudeCache = new HashMap&lt;Integer, String&gt;();<br /></pre><br /><p>Why are the type parameters declared twice?  Can't the compiler infer the types used in the call to the generic constructor from the reference declaration?  This has been asked before, and there are a <a href="http://www.jroller.com/scolebourne/entry/java_7_short_declarations">few proposals</a>, but Neal Gafter's <a href="http://gafter.blogspot.com/2007/07/constructor-type-inference.html">recent post</a> seems the slickest to me.</p><br /><p>He proposes this syntax</p><br /><pre class="codeBlock"><br />Map &lt;Integer, String&gt; crudeCache = new HashMap&lt;&gt;();<br /></pre><br /><p>where the final &lt;&gt; is a signal to javac to do its type inference magic.  I like that.  The amount of typing is not that important - I haven't measured it, but I am sure I spend more time looking reading, and thinking about code than actually typing it.  Anyway, I rely on my IDE to do a lot of boilerplate coding.  However, this syntax looks much more elegant and readable.  So, then why not go one step further and omit the &lt;&gt;:</p><br /><pre class="codeBlock"><br />Map &lt;Integer, String&gt; crudeCache = new HashMap();<br /></pre><br /><p>Can't the compiler infer type in this case too?  Unfortunately not, as this would be confused with a backwardly compatible call to a raw type constructor.  Remember that raw types really are <a href="http://www.angelikalanger.com/GenericsFAQ/FAQSections/ParameterizedTypes.html#What%20is%20the%20difference%20between%20the%20unbounded%20wildcard%20instantiation%20and%20the%20raw%20type?">different</a> from unbounded wildcards, so for compatibility with legacy code they need to stay.  It is a pity that the least frequent use (raw type) would be the most terse.</p><br /><p>Type inference in general is a pretty tricky problem.  Java tries on occasion in a fairly simplistic way.  Take for example</p><br /><pre class="codeBlock"><br />List<String> noStrings = Collections.emptyList();<br /></pre><br /><p>In that situation javac manages to infer the type from the reference assignment.  Interestingly, the implementation of the <code>emptyList</code> method is rather crude looking.  It simply casts a raw List into the desired type and hides this chicanery behind a <code>@SuppressWarnings("unchecked")</code>.  However, typing is not compromised - you can't ever get anything out of the list, as it is immutable and has zero size, so the apparently unsafe cast is sound.</p><br /><p>When you not encumbered by backwards compatibility, simple syntax comes more easily.  Take for example how Scala handles this issue:</p><br /><pre class="codeBlock"><br />val scalaMap = new HashMap[Int, String](1, "types inferred")<br /></pre><br /><p>Whilst that concise syntax looks like it comes from a dynamically typed language, Scala is as statically typed as Java.  But as the type system is so well constrained, the <a href="http://lamp.epfl.ch/~odersky/">designer</a> (who was on the original Java generics "GJ" team) has been able to use <a href="http://www.scala-lang.org/intro/inference.html">local type inference</a> to provide both the generic type information, and the type of the reference declaration itself.  I am impressed by the clean look, but I think I'd miss the reference type on the left had side of the assignment as it must help when reading through the code.  Interesting to see what can be done on the jvm when you start with a clean sheet though.</p><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://serg.io/blog/labels/java generics.html">java generics</a></p>
    <div class="byline">
        <a href="http://serg.io/blog/2007/10/java-generics-and-constructor-type.html" title="permanent link">#</a> posted by Sergio on Sunday, October 07, 2007
        
            &nbsp;
                <a href="https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=8591086565732437373"location.href=https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=8591086565732437373;><span style="text-transform:lowercase">0 Comments</span></a>
            
            
                <a class="comment-link" href="http://serg.io/blog/2007/10/java-generics-and-constructor-type.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=8591086565732437373" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=8591086565732437373" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>

<h2>Hudson - great for when you need a lightweight CI tool in a hurry</h2><a name="134187885845236193"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>On a recent project a colleague recommended <a href="https://hudson.dev.java.net/">Hudson</a> which turned out to be a very good call indeed.  The team was genuinely impressed.  Despite the tagline claiming it is an "Extensible continuous integration engine" - seriously Hudson people, drop the "engine" - that smells like a programming vapourword.  Anyway, continuous integration tools seem to be aligning themselves into two camps, <a href="http://www.jetbrains.com/teamcity">big</a> <a href="http://cruisecontrol.sourceforge.net">fat</a> <a href="http://www.anthillpro.com">do everything</a> ones, and <a href="http://maven.apache.org/continuum">small</a> <a href="http://www.atlassian.com/software/bamboo">neat</a> <a href="http://gump.apache.org">lightweight</a> ones.  Hudson is now firmly at the top of my list of the second flavour.<br /></p><p><br />So this is why it is well suited to short, dare I say agile, projects:<br /><ul><br /><li>Trivial installation – the released package is a war file, so you drop it in your web container of choice and away you go.</li><br /><li>Configuration – going with the lightweight rapid theme, there is not much to configure.  However, Hudson scores with a really intuitive gui. No need to read the docs.</li><br /><li>Feature set – it had everything required for the tight timescale project I was working on – namely subversion integration (naturally), cron (<a href="http://www.opensymphony.com/quartz">quartz</a> I guess) style scheduling, rss feeds for build results, JUnit report rendering, and a really sweet unix tail style build output watcher.</li><br /></ul><br /></p><p><br />and this is what is not quite perfect<br /><ul><br /><li>Missing a couple of features, such as support for alerting build status over chat, and delayed commit.</li><br /><li>Although there seems to be a decent swell of support for Hudson, and it has an open extension system, there just aren’t that many compelling extensions yet.</li><br /><li>No support that I could find for adding in code coverage reporting.</li><br /><li>A successful build shows a <span style="color: blue;">blue</span> rather than <span style="color: red;">red</span> traffic light.  That’s just confusing.  Like is blue good or bad?</li><br /></ul><br /><p></p><p><br />Really though, I am just splitting hairs. Hudson was very impressive.<br /></p><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://serg.io/blog/labels/continuous integration.html">continuous integration</a></p>
    <div class="byline">
        <a href="http://serg.io/blog/2007/08/hudson-great-for-when-you-need.html" title="permanent link">#</a> posted by Sergio on Tuesday, August 14, 2007
        
            &nbsp;
                <a href="https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=134187885845236193"location.href=https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=134187885845236193;><span style="text-transform:lowercase">0 Comments</span></a>
            
            
                <a class="comment-link" href="http://serg.io/blog/2007/08/hudson-great-for-when-you-need.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=134187885845236193" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=134187885845236193" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>

<h2>Java application config choices</h2><a name="7746840386685171518"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>I took some good-natured jibing on my last project about the level to which I wanted to make the application configurable.  My innate pedantry meant that I was driven to throw as much of the configuration and even logic into external files.  Frameworks like Spring positively encourage this - why would you ever have a hard-coded static constant, when you can inject a value from xml?  And why stop there - why not config your Spring config files with a <code><a href="http://www.springframework.org/docs/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html">PropertyPlaceholderConfigurer</a></code>...  Well, my colleagues have made me think a bit more about this approach.  Clearly, there is some config data that no-one is quibbling about - database credentials for exmple, simply do not live hard coded into the application.  But what about other meta data?  Like say a number format pattern?  Or an SQL string?</p><br /><p>There are lots of choices for where metadata can reside, and picking the appropriate one is key.  Databases and properties files are great for config that often needs changing on the fly.  For example, the number format for a column in an online report.  However, they add a level of indirection during development which is anooying as the data is physically separated from the source.  They are also not well suited to refactoring, although IDEs ease some of the pain these days.</p><br /><p>Annotations are at the other extreme as they are bound to the source.  They're appropriate for a different category of metadata - when your config drives the code's core functionality.  The classic example is a SQL (or an object query language) string which is well suited to living in annotated methods in DAOs.  There is no point having it in an easliy-changed properties file because when you change your SQL you are fundamentally impacting the behaviour.  That is not a runtime activity.  However, annotations are more verbose to create.  Moreover they are easily abused and overused resulting in bloated, messy code.</p><br /><p>As an aside, and a great example of annotation abuse, I really don't like JUnit 4's <code><a href="http://www.junit.org/junit/javadoc/4.3/org/junit/Ignore.html">@Ignore</a></code> - if the test is broken then fix the damn thing!  That is just encouraging sloppiness.  It is even worse than commenting out a broken test as it kind of looks official - like you somehow meant to do it.  As much as I hate to admit it, at least a chunk of commented out test code is a big red flag that shouts at you to go back and get the thing to pass.</p><br /><p>So to sum up, the choices available in Java are increasing all the time.  Spring for example ships with more and more annotations.  In addition support is there for bean wiring by xml, properties files and programatically through the api.  In a slightly obtuse way, their new dynamic language support can be thought of as config - you can certainly use it to inject new bahaviour at runtime.  The choice can only be a good thing (I don't want to be forced to use EJB 2 deployment descriptors ever again).  It just means I've got to think more carefully about where application metadata should live and not just dump anything that looks like config into properties files.</p><div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://serg.io/blog/labels/config.html">config</a>, <a rel='tag' href="http://serg.io/blog/labels/java.html">java</a>, <a rel='tag' href="http://serg.io/blog/labels/spring.html">spring</a></p>
    <div class="byline">
        <a href="http://serg.io/blog/2007/08/java-application-config-choices.html" title="permanent link">#</a> posted by Sergio on Sunday, August 05, 2007
        
            &nbsp;
                <a href="https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=7746840386685171518"location.href=https://www.blogger.com/comment.g?blogID=4414172998613045683&postID=7746840386685171518;><span style="text-transform:lowercase">0 Comments</span></a>
            
            
                <a class="comment-link" href="http://serg.io/blog/2007/08/java-application-config-choices.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=7746840386685171518" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=7746840386685171518" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>

<h2>Easy transactional DAO JUnit tests using Spring</h2><a name="9180535329988123917"></a>
<div class="blogPost">
    <div style="clear:both;"></div><p>This is nice quick win from the wizards at Spring.  It is all in the doco, but I thought it was worthy of a post as it is very elegant.  Unit testing a traditional DAO always gives the problem of what to do with test data that gets left in the database.  Even if individual developers have their own database schema that gets cleared down and set up each time your test suite runs, you can get problems with data from one test polluting the next.  In the worst case, your test cases start to depend on the order in which they're run.<br /><br />Spring provides an absurdly long named, but very handy superclass for your JUnit test cases: <code><a href="http://www.springframework.org/docs/api/org/springframework/test/AbstractTransactionalDataSourceSpringContextTests.html">AbstractTransactionalDataSourceSpringContextTests</a></code><br /><br />Writing your test cases in a subclass of this will mean that each case seamlessly runs in its own transaction.  Spring starts a transaction before the test case method is invoked, then rolls it back on completion (pass or fail).<br /><br />Here's an example:<br /><pre class="codeBlock"><br />package io.serg.dao;<br /> <br />import java.util.Collection;<br />import org.junit.Test;<br />import org.springframework.test.<br />    AbstractTransactionalDataSourceSpringContextTests;<br />import io.serg.Customer;<br /> <br />public class CustomerDaoTest extends <br />    AbstractTransactionalDataSourceSpringContextTests {<br /> <br />   private ICustomerDao customerDao;<br /> <br />   public void setCustomerDao(ICustomerDao customerDao) {<br />      this.customerDao = customerDao;<br />   }<br /> <br />   @Test<br />   public void testGetAllCustomers() {<br /> <br />      Collection<icustomer> customers = this.customerDao.getAllCustomers();<br />      assertNotNull(customers);<br />      assertFalse(customers.isEmpty());<br />   }<br />}<br /> <br /></pre><br />The bean config to get this to work is very simple:<br /><pre class="codeBlock"><br />&lt;bean id="customerDao" <br />   class="io.serg.dao.CustomerDao"&gt;<br /><br />  &lt;property name="dataSource" ref="dataSource"/&gt;<br />&lt;/bean&gt;<br /> <br />&lt;bean id="dataSource" <br />   class="org.apache.commons.dbcp.BasicDataSource"<br />   destroy-method="close"&gt;<br />   <br />  &lt;property name="driverClassName" value="${jdbc.driverClass}"/&gt;<br />  &lt;property name="url" value="${jdbc.url}"/&gt;<br />  &lt;property name="username" value="${jdbc.username}"/&gt;<br />  &lt;property name="password" value="${jdbc.password}"/&gt;<br />&lt;/bean&gt;<br /> <br />&lt;bean id="transactionManager" <br />   class="org.springframework.jdbc.//<br />   datasource.DataSourceTransactionManager"&gt;<br /><br />  &lt;property name="dataSource" ref="dataSource"/&gt;<br />&lt;/bean&gt;<br /> <br /></pre><br />Note that we're using Spring's <a href="http://www.springframework.org/docs/reference/beans.html#beans-factory-autowiring-modes-tbl">autowire by type</a> to inject the transaction manager into our unit test superclass.  Still don't know what my feelings are about autowiring - my inate fear of all things magical means I'm trying to resist, but it does seem very neat in small examples like this.<br /><br />Clearly this is a very simple example, but more complex interactions with the database can be tested in this way, including the case where you do actually want to commit a transaction part way through a unit test (see the javadocs for <code><a href="http://www.springframework.org/docs/api/org/springframework/test/AbstractTransactionalSpringContextTests.html">org.springframework.test.AbstractTransactionalSpringContextTests</a></code>, specifically the <code><a href="http://www.springframework.org/docs/api/org/springframework/test/AbstractTransactionalSpringContextTests.html#setComplete()">setComplete()</a></code> method and <code><a href="http://www.springframework.org/docs/api/org/springframework/test/AbstractTransactionalSpringContextTests.html#setDefaultRollback(boolean)">defaultRollback</a></code> property).<br /><br />This is a particularly sweet solution for the problem of unit testing your DAOs.  You don’t need a separate test database per developer and you can run these concurrently and let the RDBMS handle the traffic.  <br /><br />The principle argument against this technique is that you are still physically hitting the database so you are not just unit testing the DAO code.  But in all honesty, unless you are going to mock up your datasource and jdbc connection (very painful) there is little alternative.  In the real world, unless you go down the OR mapping route, your DAO and database are irrevicably linked.  Furthermore, Spring allows you to write very clean DAOs which do almost nothing beyond handle the interaction with a relational database, so what else is there to test anyway?<div style="clear:both; padding-bottom:0.25em"></div><p class="blogger-labels">Labels: <a rel='tag' href="http://serg.io/blog/labels/java.html">java</a>, <a rel='tag' href="http://serg.io/blog/labels/spring.html">spring</a>, <a rel='tag' href="http://serg.io/blog/labels/testing.html">testing</a></p>
    <div class="byline">
        <a href="http://serg.io/blog/2007/05/easy-transactional-dao-junit-tests.html" title="permanent link">#</a> posted by Sergio on Tuesday, May 15, 2007
        
            
            
                <a class="comment-link" href="http://serg.io/blog/2007/05/easy-transactional-dao-junit-tests.html#links"><span style="text-transform:lowercase">Links to this post</span></a>
            
         <span class="item-action"><a href="http://www.blogger.com/email-post.g?blogID=4414172998613045683&postID=9180535329988123917" title="Email Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_email.gif" height="13" width="18"/></a></span><span class="item-control blog-admin pid-1245354090"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4414172998613045683&postID=9180535329988123917" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
        <br/>
        <br/>
        <br/>
        <span style="text-align:right; display:block;">
subscribe by <a href="http://www.feedburner.com/fb/a/emailverifySubmit?feedId=1077454&amp;loc=en_US">email</a> or
<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml">rss</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio" rel="alternate" type="application/rss+xml"><img src="http://serg.io/blog/images/feed-icon-12x12.png" alt="subscribe to blog updates" style="vertical-align:middle;border:0"/></a>
        </span>
    </div>
</div>

<br/>
<hr/>
<br/>


</div>
<!-- end div#welcome -->

<!--div id="sample1" class="boxed">
    
    <h2>Sample One</h2>
    <ul>
        <li><a href="#">Ut semper vestibulum est</a></li>
        <li><a href="#">Vestibulum luctus venenatis </a></li>
        <li><a href="#">Etiam malesuada enim</a></li>
        <li><a href="#">Aenean elementum facilisis </a></li>
        
        <li><a href="#">Ut tincidunt elit vitae augue</a></li>
        <li><a href="#">Sed quis odio sagittis leo </a></li>
    </ul>
</div-->
<!-- end div#sample1 -->
<!--div id="sample2" class="boxed">
    <h2>Sample Two</h2>
    
    <p>Quisque dictum nisl risus, sagittis, rutrum id, and nibh:</p>
    <ul>
        <li><a href="#">Integer rutrum nisl in mi</a></li>
        <li><a href="#">Etiam malesuada enim</a></li>
        <li><a href="#">Aenean elementum facilisis </a></li>
    </ul>
</div-->

<!-- end div#sample2 -->
</div>
<!-- end div#content -->
<div id="sidebar">
    <ul>
        <li id="submenu">
            <h2>Archives</h2>
            <ul>
                <li><a href='http://serg.io/blog/2007_05_01_archive.html'>May 2007</a></li><li><a href='http://serg.io/blog/2007_08_01_archive.html'>August 2007</a></li><li><a href='http://serg.io/blog/2007_10_01_archive.html'>October 2007</a></li><li><a href='http://serg.io/blog/2007_11_01_archive.html'>November 2007</a></li><li><a href='http://serg.io/blog/2008_01_01_archive.html'>January 2008</a></li><li><a href='http://serg.io/blog/2008_08_01_archive.html'>August 2008</a></li>
                <!-- Link to the front page, from your archives -->
                <script type="text/javascript">if (location.href.indexOf("archive")!=-1) document.write("<li><strong><a href=\"http://serg.io/blog/\">Current Posts</a></strong></li>");</script> 
            </ul>
        </li>
        <!-- end li#submenu -->
        <li id="news">
            <h2>Blog posts I'm reading</h2>
            <ul id="feed">

            </ul>
        </li>
        <!-- end li#news -->
    </ul>
    
    <!--div class='adsense' style='text-align:center; padding: 0px 3px 0.5em 3px;'>
                        <script type="text/javascript"--><!--
                            google_ad_client="pub-9053212304658958";
                            google_ad_host="pub-1556223355139109";
                            google_ad_width=300;
                            google_ad_height=250;
                            google_ad_format="300x250_as";
                            google_ad_type="text";
                            google_color_border="F6F6F6";
                            google_color_bg="F6F6F6";
                            google_color_link="000000";
                            google_color_url="777777";
                            google_color_text="9E5205";
                            //-->
    <!--/script>
                        <script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
                    </div-->  
                    
</div>
<!-- end div#sidebar -->

<div style="clear: both; height: 1px"></div>
</div>
<!-- end div#page -->
<div id="footer">
    <p id="legal">Copyright &copy; 2007 serg.io.  Thanks to <a href="http://www.freecsstemplates.org/">Free CSS Templates</a> for css design.</p>
    <p id="links"><a href="#">Privacy Policy</a> | <a href="#">Terms of Use</a> | <a href="http://feeds.feedburner.com/Sergio">Subscribe</a>&nbsp;<a href="http://feeds.feedburner.com/Sergio"><img style="border: none; vertical-align: middle;" src="images/feed-icon-12x12.png" alt="subscribe to blog updates" title="subscribe to blog updates" /></a></p>
<br/>
    <!-- In accordance to the Blogger terms of service, please leave this button somewhere on your blogger-powered page. Thanks! -->
    <p>
        <a href="http://www.blogger.com">
            <img width="88" height="31" src="http://buttons.blogger.com/bloggerbutton1.gif" border="0" alt="This page is powered by Blogger. Isn't yours?" />
        </a>
    </p>
<p>
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.0/uk/">
<img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/2.0/uk/88x31.png" />
</a>
<br />This work by 
<a xmlns:cc="http://creativecommons.org/ns#" href="http://serg.io" property="cc:attributionName" rel="cc:attributionURL">http://serg.io</a> is licensed under a 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.0/uk/">Creative Commons Attribution-Non-Commercial-Share Alike 2.0 UK: England & Wales License</a>.
</p>
</div>
<!-- end div#footer -->
</div>
<!-- end div#wrapper -->

<!-- twitter updates -->
<script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
<script text="text/javascript" src="http://twitter.com/statuses/user_timeline/serg10.json?callback=twitterCallback2&count=1"></script>

</body>
</html>